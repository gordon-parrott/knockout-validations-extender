!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;"undefined"!=typeof window?n=window:"undefined"!=typeof global?n=global:"undefined"!=typeof self&&(n=self),n.knockoutValidationsExtender=e()}}(function(){var define;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module){(function(global){var ko,performValidation,utils,_;_="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,ko="undefined"!=typeof window?window.ko:"undefined"!=typeof global?global.ko:null,utils=_dereq_("./utils"),performValidation=_dereq_("./performValidation"),module.exports=function(options){var alwaysLive,getValidationMethods,live;return live=(null!=options?options.live:void 0)||!1,alwaysLive=(null!=options?options.alwaysLive:void 0)||!1,getValidationMethods=options.getValidationMethods,function(target,rules){var allCalculatedErrors,allErrors,allManualErrors,children,childrenCalculatedErrors,childrenErrors,childrenManualErrors,hasLiveStarted,isValid,ownCalculatedErrors,ownErrors,ownManualErrors;return hasLiveStarted=!1,rules=rules||{},ko.isObservable(rules)||(rules=ko.observable(rules)),ownCalculatedErrors=ko.observableArray(),ownManualErrors=ko.observableArray(),ownErrors=ko.computed(function(){return ownCalculatedErrors().concat(ownManualErrors())}),children=ko.computed(function(){var array;return array=[],utils.iterateChildrenObservable(target,function(child){return array.push(child)}),array}),childrenCalculatedErrors=ko.computed(function(){return utils.collectChildrenObservableErrors(children(),"getAllCalculatedErrors")}),childrenManualErrors=ko.computed(function(){return utils.collectChildrenObservableErrors(children(),"getAllManualErrors")}),childrenErrors=ko.computed(function(){return childrenCalculatedErrors().concat(childrenManualErrors())}),allCalculatedErrors=ko.computed(function(){return ownCalculatedErrors().concat(childrenCalculatedErrors())}),allManualErrors=ko.computed(function(){return ownManualErrors().concat(childrenManualErrors())}),allErrors=ko.computed(function(){return allCalculatedErrors().concat(allManualErrors())}),isValid=ko.computed(function(){return 0===allErrors().length}),target.isValid=isValid,target.isntValid=ko.computed(function(){return!target.isValid()}),target.getAllErrors=allErrors,target.getAllCalculatedErrors=allCalculatedErrors,target.getAllManualErrors=allManualErrors,target.getOwnErrors=ownErrors,target.getOwnCalculatedErrors=ownCalculatedErrors,target.getOwnManualErrors=ownManualErrors,target.hasOwnErrors=ko.computed(function(){var _ref;return(null!=(_ref=target.getOwnErrors())?_ref.length:void 0)>0}),target.getChildrenErrors=childrenErrors,target.getChildrenCalculatedErrors=childrenCalculatedErrors,target.getChildrenManualErrors=childrenManualErrors,target.errors=target.getAllErrors,target.joinedErrors=function(separator){return ko.computed(function(){return target.errors().join(separator)})},target.resetValidation=function(){var child,_i,_len,_ref,_results;for(ownCalculatedErrors([]),ownManualErrors([]),_ref=children(),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)child=_ref[_i],_results.push(_.isFunction(null!=child?child.validate:void 0)?child.resetValidation():void 0);return _results},target.validate=function(opts,cb){return _.isFunction(opts)&&(cb=opts,opts={}),cb=cb||function(){},performValidation({validationMethods:getValidationMethods(),rules:ko.unwrap(rules),target:target,children:children(),resetValidation:(null!=opts?opts.reset:void 0)||!1,validateChildren:(null!=opts?opts.validateChildren:void 0)||!0},function(ownErrors){return ownCalculatedErrors(_.uniq(ownErrors)),cb(target.isValid())})},target.hasValidation=function(rule){return null!=rules[rule]},target.validation=function(newRule,options){return newRule?(rules()[newRule]=options||{},target):target},live&&(rules.subscribe(function(){return _.defer(function(){return hasLiveStarted?target.validate():void 0})}),target.subscribe(function(){return _.defer(function(){return target.validate()})}),alwaysLive&&_.defer(function(){return hasLiveStarted=!0,target.validate()})),target}}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./performValidation":3,"./utils":4}],2:[function(_dereq_,module){(function(global){var basicOptions,defaultMessage,extender,ko,validationMethods,_;ko="undefined"!=typeof window?window.ko:"undefined"!=typeof global?global.ko:null,_="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,extender=_dereq_("./extender"),validationMethods={},defaultMessage="Field is not valid",module.exports.registerValidationMethods=function(otherValidationMethods){return validationMethods=_.extend(validationMethods,otherValidationMethods),module.exports},module.exports.setDefaultMessage=function(msg){return defaultMessage=msg,module.exports},basicOptions={getValidationMethods:function(){return validationMethods},live:!1},ko.extenders.validations=extender(basicOptions),ko.extenders.validationsLive=extender(_.extend(_.clone(basicOptions),{live:!0})),ko.extenders.validationsAlwaysLive=extender(_.extend(_.clone(basicOptions),{live:!0,alwaysLive:!0}))}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./extender":1}],3:[function(_dereq_,module){(function(global){var Promise,createValidationPromise,defaultValidationObservableOptions,ko,logger,newPromise,performChildrenValidations,performOwnValidations,performValidation,_;_="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,ko="undefined"!=typeof window?window.ko:"undefined"!=typeof global?global.ko:null,logger=_dereq_("loglevel"),Promise=_dereq_("promiz"),newPromise=_dereq_("./utils").newPromise,defaultValidationObservableOptions={stopOnFirstError:!1},module.exports=performValidation=function(options,callback){var children,defaultMessage,observableValue,promises,resetValidation,rules,target,validateChildren,validationMethods;return validationMethods=(null!=options?options.validationMethods:void 0)||{},defaultMessage=(null!=options?options.defaultMessage:void 0)||"Field is not valid",rules=(null!=options?options.rules:void 0)||{},target=(null!=options?options.target:void 0)||function(){throw new Error("target is required")}(),observableValue=target(),children=(null!=options?options.children:void 0)||[],resetValidation=null!=options?options.resetValidation:void 0,validateChildren=null!=options?options.validateChildren:void 0,resetValidation&&target.resetValidation(),promises=[],promises.push(performOwnValidations(rules,validationMethods,observableValue,defaultMessage)),promises.push(validateChildren?performChildrenValidations(children,resetValidation):newPromise([])),newPromise(promises).spread(function(ownErrors){return callback?callback(ownErrors):ownErrors}).fail(function(){return function(error){return logger.error(error),callback([defaultMessage])}}(this)).done()},performOwnValidations=function(rules,validationMethods,observableValue,defaultMessage){var errors,executeNextValidation,observableOptions,rule,ruleOptions,stack;return observableOptions=_.clone(defaultValidationObservableOptions),_.isObject(null!=rules?rules.options:void 0)&&(observableOptions=_.extend(observableOptions,rules.options)),errors=[],stack=function(){var _results;_results=[];for(rule in rules)ruleOptions=rules[rule],_results.push({rule:rule,ruleOptions:ruleOptions});return _results}().reverse(),executeNextValidation=function(){var entry,promise;return(null!=stack?stack.length:void 0)?(entry=stack.pop(),rule=entry.rule,ruleOptions=entry.ruleOptions,promise=createValidationPromise(rule,ruleOptions,validationMethods,observableValue),promise?promise.then(function(result){var _ref;return result||errors.push((null!=ruleOptions?ruleOptions.message:void 0)||(null!=(_ref=validationMethods[rule])?_ref.defaultMessage:void 0)||defaultMessage),(null!=errors?errors.length:void 0)&&observableOptions.stopOnFirstError?newPromise():executeNextValidation()}):executeNextValidation()):newPromise()},executeNextValidation().then(function(){return _.filter(errors,function(error){return null!=error})})},performChildrenValidations=function(children,resetValidation){var child,promises,_i,_len;for(promises=[],_i=0,_len=children.length;_len>_i;_i++)child=children[_i],_.isFunction(null!=child?child.validate:void 0)&&promises.push(Promise.nfcall(child.validate,{reset:resetValidation,validateChildren:!1}));return(null!=promises?promises.length:void 0)?newPromise(promises).all():newPromise([])},createValidationPromise=function(rule,ruleOptions,validationMethods,observableValue){var async,ruleOptsOrFn;return ruleOptsOrFn=validationMethods[rule],_.isFunction(ruleOptsOrFn)?Promise.fcall(ruleOptsOrFn,{value:observableValue,validationOptions:ruleOptions}):_.isFunction(null!=ruleOptsOrFn?ruleOptsOrFn.fn:void 0)?(async=ruleOptsOrFn.async||!1,async?Promise.nfcall(ruleOptsOrFn,{value:observableValue,validationOptions:ruleOptions}):Promise.fcall(ruleOptsOrFn,{value:observableValue,validationOptions:ruleOptions})):void("options"!==rule&&logger.warn("Validation Method with name "+rule+" doesnt exist"))}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./utils":4,loglevel:5,promiz:6}],4:[function(_dereq_,module){(function(global){var Promise,collectChildrenErrors,collectChildrenObservableErrors,isObservableArray,iterateChildrenObservable,ko,newPromise,_;_="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,ko="undefined"!=typeof window?window.ko:"undefined"!=typeof global?global.ko:null,Promise=_dereq_("promiz"),module.exports.isObservableArray=isObservableArray=function(obj){return ko.isObservable(obj)&&!(void 0===obj.destroyAll)},module.exports.newPromise=newPromise=function(value){var deferred;return deferred=Promise.defer(),setTimeout(function(){return deferred.resolve(value)},0),deferred},module.exports.collectChildrenErrors=collectChildrenErrors=function(childrenErrors){var childErrors,errorsToReturn,recursiveCollectChildrenErrors,_i,_len;for(errorsToReturn=[],recursiveCollectChildrenErrors=function(childErrors){var otherChildErrors,_i,_len,_ref,_results;for(errorsToReturn=errorsToReturn.concat(childErrors.ownErrors),_ref=childErrors.childrenErrors,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)otherChildErrors=_ref[_i],_results.push(recursiveCollectChildrenErrors(otherChildErrors));return _results},_i=0,_len=childrenErrors.length;_len>_i;_i++)childErrors=childrenErrors[_i],recursiveCollectChildrenErrors(childErrors);return errorsToReturn},module.exports.collectChildrenObservableErrors=collectChildrenObservableErrors=function(children,errorsFnName){var childrenObservable,errors,_i,_len;for(errors=[],_i=0,_len=children.length;_len>_i;_i++)childrenObservable=children[_i],_.isFunction(null!=childrenObservable?childrenObservable[errorsFnName]:void 0)&&(errors=errors.concat(childrenObservable[errorsFnName]()));return errors},module.exports.iterateChildrenObservable=iterateChildrenObservable=function(target,iterator){var iteratePossibleChildObservable,key,observableValue,possibleObservable,value,_i,_len,_results,_results1;if(iteratePossibleChildObservable=function(possibleObservable){return ko.isObservable(possibleObservable)||isObservableArray(possibleObservable)?iterator(possibleObservable):_.isArray(possibleObservable)||_.isObject(possibleObservable)?iterateChildrenObservable(possibleObservable,iterator):void 0},observableValue=ko.unwrap(target),_.isArray(observableValue)){for(_results=[],_i=0,_len=observableValue.length;_len>_i;_i++)possibleObservable=observableValue[_i],_results.push(iteratePossibleChildObservable(possibleObservable));return _results}if(_.isObject(observableValue)){_results1=[];for(key in observableValue)value=observableValue[key],_results1.push(iteratePossibleChildObservable(value));return _results1}}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{promiz:6}],5:[function(_dereq_,module){!function(undefined){var undefinedType="undefined";!function(name,definition){"object"==typeof module&&module.exports&&"function"==typeof _dereq_?module.exports=definition():"function"==typeof define&&"object"==typeof define.amd?define(definition):this[name]=definition()}("log",function(){function realMethod(methodName){return typeof console===undefinedType?noop:console[methodName]===undefined?console.log!==undefined?boundToConsole(console,"log"):noop:boundToConsole(console,methodName)}function boundToConsole(console,methodName){var method=console[methodName];if(method.bind!==undefined)return console[methodName].bind(console);if(Function.prototype.bind===undefined)return functionBindingWrapper(method,console);try{return Function.prototype.bind.call(console[methodName],console)}catch(e){return functionBindingWrapper(method,console)}}function functionBindingWrapper(f,context){return function(){Function.prototype.apply.apply(f,[context,arguments])}}function replaceLoggingMethods(methodFactory){for(var ii=0;ii<logMethods.length;ii++)self[logMethods[ii]]=methodFactory(logMethods[ii])}function cookiesAvailable(){return typeof window!==undefinedType&&window.document!==undefined&&window.document.cookie!==undefined}function localStorageAvailable(){try{return typeof window!==undefinedType&&window.localStorage!==undefined&&null!==window.localStorage}catch(e){return!1}}function persistLevelIfPossible(levelNum){var levelName,localStorageFail=!1;for(var key in self.levels)if(self.levels.hasOwnProperty(key)&&self.levels[key]===levelNum){levelName=key;break}if(localStorageAvailable())try{window.localStorage.loglevel=levelName}catch(e){localStorageFail=!0}else localStorageFail=!0;localStorageFail&&cookiesAvailable()&&(window.document.cookie="loglevel="+levelName+";")}function loadPersistedLevel(){var storedLevel;if(localStorageAvailable()&&(storedLevel=window.localStorage.loglevel),storedLevel===undefined&&cookiesAvailable()){var cookieMatch=cookieRegex.exec(window.document.cookie)||[];storedLevel=cookieMatch[1]}self.levels[storedLevel]===undefined&&(storedLevel="WARN"),self.setLevel(self.levels[storedLevel])}var self={},noop=function(){},logMethods=["trace","debug","info","warn","error"],cookieRegex=/loglevel=([^;]+)/;self.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},self.setLevel=function(level){if("number"==typeof level&&level>=0&&level<=self.levels.SILENT){if(persistLevelIfPossible(level),level===self.levels.SILENT)return void replaceLoggingMethods(function(){return noop});if(typeof console===undefinedType)return replaceLoggingMethods(function(methodName){return function(){typeof console!==undefinedType&&(self.setLevel(level),self[methodName].apply(self,arguments))}}),"No console available for logging";replaceLoggingMethods(function(methodName){return level<=self.levels[methodName.toUpperCase()]?realMethod(methodName):noop})}else{if("string"!=typeof level||self.levels[level.toUpperCase()]===undefined)throw"log.setLevel() called with invalid level: "+level;self.setLevel(self.levels[level.toUpperCase()])}},self.enableAll=function(){self.setLevel(self.levels.TRACE)},self.disableAll=function(){self.setLevel(self.levels.SILENT)};var _log=typeof window!==undefinedType?window.log:undefined;return self.noConflict=function(){return typeof window!==undefinedType&&window.log===self&&(window.log=_log),self},loadPersistedLevel(),self})}()},{}],6:[function(_dereq_,module){!function(){function promise(fn,er){var self=this;self.promise=self,self.state="pending",self.val=null,self.fn=fn||null,self.er=er||null,self.next=[]}var now="undefined"!=typeof setImmediate?setImmediate:function(cb){setTimeout(cb,0)};promise.prototype.resolve=function(v){var self=this;"pending"===self.state&&(self.val=v,self.state="resolving",now(function(){self.fire()}))},promise.prototype.reject=function(v){var self=this;"pending"===self.state&&(self.val=v,self.state="rejecting",now(function(){self.fire()}))},promise.prototype.then=function(fn,er){var self=this,p=new promise(fn,er);return self.next.push(p),"resolved"===self.state&&p.resolve(self.val),"rejected"===self.state&&p.reject(self.val),p},promise.prototype.fail=function(er){return this.then(null,er)},promise.prototype.finish=function(type){var self=this;self.state=type,"resolved"===self.state&&self.next.map(function(p){p.resolve(self.val)}),"rejected"===self.state&&self.next.map(function(p){p.reject(self.val)})},promise.prototype.thennable=function(ref,cb,ec,cn,val){var self=this;if(val=val||self.val,"object"==typeof val&&"function"==typeof ref)try{var cnt=0;ref.call(val,function(v){0===cnt++&&cb(v)},function(v){0===cnt++&&ec(v)})}catch(e){ec(e)}else cn(val)},promise.prototype.fire=function(){var ref,self=this;try{ref=self.val&&self.val.then}catch(e){return self.val=e,self.state="rejecting",self.fire()}self.thennable(ref,function(v){self.val=v,self.state="resolving",self.fire()},function(v){self.val=v,self.state="rejecting",self.fire()},function(v){if(self.val=v,"resolving"===self.state&&"function"==typeof self.fn)try{self.val=self.fn.call(void 0,self.val)}catch(e){return self.val=e,self.finish("rejected")}if("rejecting"===self.state&&"function"==typeof self.er)try{self.val=self.er.call(void 0,self.val),self.state="resolving"}catch(e){return self.val=e,self.finish("rejected")}return self.val===self?(self.val=TypeError(),self.finish("rejected")):void self.thennable(ref,function(v){self.val=v,self.finish("resolved")},function(v){self.val=v,self.finish("rejected")},function(v){self.val=v,self.finish("resolving"===self.state?"resolved":"rejected")})})},promise.prototype.done=function(){if(this.state="rejected"&&!this.next)throw this.val;return null},promise.prototype.nodeify=function(cb){return"function"==typeof cb?this.then(function(val){try{cb(null,val)}catch(e){setImmediate(function(){throw e})}return val},function(val){try{cb(val)}catch(e){setImmediate(function(){throw e})}return val}):this},promise.prototype.spread=function(fn,er){return this.all().then(function(list){return"function"==typeof fn&&fn.apply(null,list)},er)},promise.prototype.all=function(){var self=this;return this.then(function(list){function done(){++cnt===target&&p.resolve(list)}var p=new promise;if(!(list instanceof Array))return p.reject(TypeError),p;for(var cnt=0,target=list.length,i=0,l=list.length;l>i;i++){var ref,value=list[i];try{ref=value&&value.then}catch(e){p.reject(e);break}!function(i){self.thennable(ref,function(val){list[i]=val,done()},function(val){list[i]=val,done()},function(){done()},value)}(i)}return p})};var promiz={defer:function(){return new promise(null,null)},fcall:function(){var def=new promise,args=Array.apply([],arguments),fn=args.shift();try{var val=fn.apply(null,args);def.resolve(val)}catch(e){def.reject(e)}return def},nfcall:function(){var def=new promise,args=Array.apply([],arguments),fn=args.shift();try{args.push(function(err,val){return err?def.reject(err):def.resolve(val)}),fn.apply(null,args)}catch(e){def.reject(e)}return def}};"undefined"!=typeof module?module.exports=promiz:self.Promiz=promiz}()},{}]},{},[2])(2)});